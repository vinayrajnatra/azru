--
Login-AzureRMAccount

$location = "South India"
$myStorageAccountName = "genstorageacntdemo"
$resourceGroupName = "XXX_PWRSHELL_RES_GROUP"

$myResourceGroup = New-AzureRmResourceGroup -Name $resourceGroupName -Location $location

$vnet = New-AzureRmVirtualNetwork -ResourceGroupName $resourceGroupName -Name TestVNet -AddressPrefix 192.168.0.0/16 -Location $location

Add-AzureRmVirtualNetworkSubnetConfig -Name FrontEnd -VirtualNetwork $vnet -AddressPrefix 192.168.1.0/24

Add-AzureRmVirtualNetworkSubnetConfig -Name BackEnd -VirtualNetwork $vnet -AddressPrefix 192.168.2.0/24

$myVnet = Set-AzureRmVirtualNetwork -VirtualNetwork $vnet

--Creation of virtual machine
$myResourceGroup = Get-AzureRMResourceGroup -Name $resourceGroupName

$myStorageAccount = New-AzureRmStorageAccount -ResourceGroupName $resourceGroupName -Name $myStorageAccountName -Type "Standard_LRS"  -Location $location


 $myPublicIp = New-AzureRmPublicIpAddress -Name "myPublicIp" -ResourceGroupName $resourceGroupName `
     -Location $location -AllocationMethod Dynamic
	 
	 
$myNIC = New-AzureRmNetworkInterface -Name "myNIC" -ResourceGroupName $resourceGroupName `
     -Location $location -SubnetId $myVnet.Subnets[0].Id -PublicIpAddressId $myPublicIp.Id

	 
$cred = Get-Credential -Message "P@ssw0rd@microsoft"

	 
$myVm = New-AzureRmVMConfig -VMName "myVM" -VMSize "Standard_DS1_v2"

	 
 $myVM = Set-AzureRmVMOperatingSystem -VM $myVM -Windows -ComputerName "myVM" -Credential $cred `
 -ProvisionVMAgent -EnableAutoUpdate
	 
	 
 $myVM = Set-AzureRmVMSourceImage -VM $myVM -PublisherName "MicrosoftWindowsServer" `
 -Offer "WindowsServer" -Skus "2012-R2-Datacenter" -Version "latest"
	 
 $myVM = Add-AzureRmVMNetworkInterface -VM $myVM -Id $myNIC.Id

	 
 $blobPath = "vhds/myOsDisk1.vhd"
 $osDiskUri = $myStorageAccount.PrimaryEndpoints.Blob.ToString() + $blobPath

 
 $myVM = Set-AzureRmVMOSDisk -VM $myVM -Name "myOsDisk1" -VhdUri $osDiskUri -CreateOption fromImage
 
 New-AzureRmVM -ResourceGroupName $resourceGroupName -Location $location -VM $myVM

 
 
 =========================================Desired State Configuration=================================
 
 Get-DscResource | select Name,Module,Properties | Ft -AutoSize 
 
 https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-how-to-use-files
 
 
 
 